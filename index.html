<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#0a0f1a">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Corp Actions">
  <meta name="description" content="Track corporate actions, dividends, splits, and calculate investment returns">
  <title>Corporate Actions Tracker</title>
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="icons/icon-192.svg">
  <link rel="icon" type="image/svg+xml" href="icons/icon-192.svg">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html, body, #root { height: 100%; width: 100%; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: linear-gradient(135deg, #0a0f1a 0%, #1a1f2e 50%, #0d1117 100%); color: #e6edf3; -webkit-font-smoothing: antialiased; }
    .loading-screen { position: fixed; inset: 0; background: linear-gradient(135deg, #0a0f1a 0%, #1a1f2e 50%, #0d1117 100%); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 9999; }
    .loading-screen.hidden { display: none; }
    .loading-logo { width: 80px; height: 80px; background: linear-gradient(135deg, #58a6ff 0%, #1f6feb 100%); border-radius: 20px; display: flex; align-items: center; justify-content: center; font-size: 36px; font-weight: bold; color: white; margin-bottom: 24px; animation: pulse 2s ease-in-out infinite; }
    @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); opacity: 0.8; } }
    .loading-text { color: #8b949e; font-size: 14px; }
  </style>
</head>
<body>
  <div id="root"></div>
  <div class="loading-screen" id="loading"><div class="loading-logo">CA</div><div class="loading-text">Loading...</div></div>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script>
    if ('serviceWorker' in navigator) { window.addEventListener('load', function() { navigator.serviceWorker.register('sw.js').catch(function(e) { console.log('SW failed:', e); }); }); }
    var e = React.createElement, useState = React.useState, useEffect = React.useEffect, useMemo = React.useMemo;
    function formatCurrency(v) { return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(v); }
    function formatPercent(v) { return (v >= 0 ? '+' : '') + v.toFixed(2) + '%'; }
    function formatDate(d) { return new Date(d).toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' }); }

    function DividendChart(props) {
      var data = props.data;
      if (!data || !data.length) return null;
      var maxVal = Math.max.apply(null, data.map(function(d) { return d.total; }));
      var recent = data.slice(-8);
      return e('div', { style: { marginTop: '16px' } },
        e('div', { style: { fontSize: '12px', color: '#8b949e', marginBottom: '12px' } }, 'Annual Dividend History'),
        e('div', { style: { display: 'flex', alignItems: 'flex-end', gap: '6px', height: '80px' } },
          recent.map(function(item, i) {
            var h = maxVal > 0 ? (item.total / maxVal) * 100 : 0;
            var grow = i > 0 && item.total > recent[i-1].total;
            var dec = i > 0 && item.total < recent[i-1].total;
            return e('div', { key: item.year, style: { flex: 1, display: 'flex', flexDirection: 'column', alignItems: 'center' } },
              e('div', { style: { width: '100%', height: h + '%', minHeight: '4px', background: dec ? '#f85149' : grow ? '#3fb950' : '#58a6ff', borderRadius: '3px 3px 0 0' } }),
              e('div', { style: { fontSize: '9px', color: '#8b949e', marginTop: '4px' } }, "'" + String(item.year).slice(-2))
            );
          })
        )
      );
    }

    function App() {
      var _ticker = useState(''), ticker = _ticker[0], setTicker = _ticker[1];
      var _searched = useState(''), searchedTicker = _searched[0], setSearchedTicker = _searched[1];
      var _amount = useState(10000), investmentAmount = _amount[0], setInvestmentAmount = _amount[1];
      var _startDate = useState('2020-01-01'), investmentDate = _startDate[0], setInvestmentDate = _startDate[1];
      var _endDate = useState(new Date().toISOString().split('T')[0]), endDate = _endDate[0], setEndDate = _endDate[1];
      var _loading = useState(false), loading = _loading[0], setLoading = _loading[1];
      var _error = useState(null), error = _error[0], setError = _error[1];
      var _apiKey = useState(localStorage.getItem('polygonApiKey') || ''), apiKey = _apiKey[0], setApiKey = _apiKey[1];
      var _showSetup = useState(true), showSetup = _showSetup[0], setShowSetup = _showSetup[1];
      var _dividends = useState([]), dividends = _dividends[0], setDividends = _dividends[1];
      var _splits = useState([]), splits = _splits[0], setSplits = _splits[1];
      var _priceData = useState(null), priceData = _priceData[0], setPriceData = _priceData[1];
      var _details = useState(null), tickerDetails = _details[0], setTickerDetails = _details[1];
      var _returns = useState(null), returnCalc = _returns[0], setReturnCalc = _returns[1];
      var _tab = useState('dividends'), activeTab = _tab[0], setActiveTab = _tab[1];
      var _price = useState(null), currentPrice = _price[0], setCurrentPrice = _price[1];
      var _recent = useState(function() { try { return JSON.parse(localStorage.getItem('recentSearches') || '[]'); } catch(e) { return []; } }), recentSearches = _recent[0], setRecentSearches = _recent[1];

      useEffect(function() { if (apiKey) localStorage.setItem('polygonApiKey', apiKey); }, [apiKey]);
      useEffect(function() { document.getElementById('loading').classList.add('hidden'); }, []);

      function addRecent(t) {
        var updated = [t].concat(recentSearches.filter(function(s) { return s !== t; })).slice(0, 5);
        setRecentSearches(updated);
        localStorage.setItem('recentSearches', JSON.stringify(updated));
      }

      function calcReturns(prices, divs, splts) {
        if (!prices || prices.length < 2) return;
        var startP = prices[0].c, endP = prices[prices.length - 1].c;
        var startD = new Date(prices[0].t), endD = new Date(prices[prices.length - 1].t);
        var shares = investmentAmount / startP, adjShares = shares;
        splts.filter(function(s) { var d = new Date(s.execution_date); return d >= startD && d <= endD; })
          .forEach(function(s) { adjShares = adjShares * (s.split_to / s.split_from); });
        var relDivs = divs.filter(function(d) { var pd = new Date(d.pay_date); return pd >= startD && pd <= endD; });
        var divIncome = 0; relDivs.forEach(function(d) { divIncome += d.cash_amount * adjShares; });
        var endVal = adjShares * endP, total = endVal + divIncome;
        var pctRet = ((total - investmentAmount) / investmentAmount) * 100;
        var yrs = (endD - startD) / (365.25 * 24 * 60 * 60 * 1000);
        var annRet = yrs > 0 ? (Math.pow(total / investmentAmount, 1/yrs) - 1) * 100 : 0;
        setReturnCalc({ startPrice: startP, endPrice: endP, sharesPurchased: shares, adjustedShares: adjShares,
          totalDividendIncome: divIncome, endingShareValue: endVal, totalReturn: total, percentReturn: pctRet,
          annualizedReturn: annRet, years: yrs, priceReturn: ((endP - startP) / startP) * 100,
          dividendCount: relDivs.length, splitCount: splts.filter(function(s) { var d = new Date(s.execution_date); return d >= startD && d <= endD; }).length });
      }

      function fetchData() {
        if (!ticker || !apiKey) return;
        setLoading(true); setError(null);
        var t = ticker.toUpperCase();
        setSearchedTicker(t); addRecent(t);
        Promise.all([
          fetch('https://api.polygon.io/v3/reference/dividends?ticker=' + t + '&limit=1000&apiKey=' + apiKey),
          fetch('https://api.polygon.io/v3/reference/splits?ticker=' + t + '&limit=1000&apiKey=' + apiKey),
          fetch('https://api.polygon.io/v3/reference/tickers/' + t + '?apiKey=' + apiKey),
          fetch('https://api.polygon.io/v2/aggs/ticker/' + t + '/range/1/day/' + investmentDate + '/' + endDate + '?adjusted=true&sort=asc&limit=50000&apiKey=' + apiKey),
          fetch('https://api.polygon.io/v2/aggs/ticker/' + t + '/prev?adjusted=true&apiKey=' + apiKey)
        ]).then(function(res) { return Promise.all(res.map(function(r) { return r.json(); })); })
        .then(function(data) {
          var divD = data[0], splitD = data[1], detD = data[2], priceD = data[3], prevD = data[4];
          if (divD.status === 'OK') setDividends(divD.results || []);
          if (splitD.status === 'OK') setSplits(splitD.results || []);
          if (detD.status === 'OK') setTickerDetails(detD.results);
          if (prevD.status === 'OK' && prevD.results && prevD.results[0]) setCurrentPrice(prevD.results[0].c);
          if (priceD.status === 'OK' && priceD.results && priceD.results.length > 0) {
            setPriceData(priceD.results);
            calcReturns(priceD.results, divD.results || [], splitD.results || []);
          }
          setShowSetup(false); setLoading(false);
        }).catch(function(err) { setError(err.message || 'Failed to fetch'); setLoading(false); });
      }

      useEffect(function() { if (priceData && dividends && splits) calcReturns(priceData, dividends, splits); }, [investmentAmount]);

      var divAnalysis = useMemo(function() {
        if (!dividends.length || !currentPrice) return null;
        var now = new Date(), oneYrAgo = new Date(now.getFullYear() - 1, now.getMonth(), now.getDate());
        var ttm = dividends.filter(function(d) { var ex = new Date(d.ex_dividend_date); return ex >= oneYrAgo && ex <= now; });
        var ttmTotal = 0; ttm.forEach(function(d) { ttmTotal += d.cash_amount; });
        var yld = currentPrice > 0 ? (ttmTotal / currentPrice) * 100 : 0;
        var byYear = {}; dividends.forEach(function(d) { var y = new Date(d.ex_dividend_date).getFullYear(); byYear[y] = (byYear[y] || 0) + d.cash_amount; });
        var yrs = Object.keys(byYear).sort();
        var yearly = yrs.map(function(y) { return { year: parseInt(y), total: byYear[y] }; });
        function cagr(n) { if (yearly.length < n + 1) return null; var r = yearly.slice(-n - 1); if (r.length < 2 || r[0].total <= 0 || r[r.length-1].total <= 0) return null; return (Math.pow(r[r.length-1].total / r[0].total, 1/n) - 1) * 100; }
        var yoy = yearly.length >= 2 ? ((yearly[yearly.length-1].total / yearly[yearly.length-2].total) - 1) * 100 : null;
        var freqMap = {}; dividends.forEach(function(d) { var f = d.frequency || 0; freqMap[f] = (freqMap[f] || 0) + 1; });
        var freqLabels = { '0': 'One-time', '1': 'Annual', '2': 'Semi-Annual', '4': 'Quarterly', '12': 'Monthly' };
        var topFreq = Object.entries(freqMap).sort(function(a, b) { return b[1] - a[1]; })[0];
        var consec = 0, curYr = now.getFullYear(), sortedYrs = yrs.map(function(y) { return parseInt(y); }).sort(function(a,b) { return b - a; });
        for (var i = 0; i < sortedYrs.length; i++) { if (sortedYrs[i] === curYr - i || sortedYrs[i] === curYr - i - 1) consec++; else break; }
        return { currentYield: yld, ttmDividendTotal: ttmTotal, yearlyData: yearly, cagr1Year: yoy, cagr3Year: cagr(3), cagr5Year: cagr(5),
          frequency: freqLabels[topFreq ? topFreq[0] : '0'] || 'Variable', consecutiveYears: consec, latestDividend: dividends[0] ? dividends[0].cash_amount : 0 };
      }, [dividends, currentPrice]);

      var stats = useMemo(function() {
        var now = new Date();
        return { totalDividends: dividends.length, totalSplits: splits.length,
          upcomingDividends: dividends.filter(function(d) { return new Date(d.ex_dividend_date) > now; }),
          upcomingSplits: splits.filter(function(s) { return new Date(s.execution_date) > now; }) };
      }, [dividends, splits]);

      var s = {
        container: { minHeight: '100vh', background: 'linear-gradient(135deg, #0a0f1a 0%, #1a1f2e 50%, #0d1117 100%)', paddingBottom: '80px' },
        header: { background: 'rgba(13,17,23,0.95)', backdropFilter: 'blur(20px)', borderBottom: '1px solid rgba(48,54,61,0.6)', padding: '16px', position: 'sticky', top: 0, zIndex: 100 },
        card: { background: 'rgba(13,17,23,0.6)', border: '1px solid rgba(48,54,61,0.8)', borderRadius: '12px', padding: '16px', marginBottom: '12px' },
        input: { width: '100%', padding: '14px 16px', background: 'rgba(13,17,23,0.6)', border: '1px solid rgba(48,54,61,0.8)', borderRadius: '10px', color: '#e6edf3', fontSize: '16px', outline: 'none', boxSizing: 'border-box' },
        btn: { width: '100%', padding: '16px', background: 'linear-gradient(135deg, #1f6feb 0%, #58a6ff 100%)', border: 'none', borderRadius: '12px', color: '#fff', fontSize: '16px', fontWeight: '600', cursor: 'pointer' },
        label: { display: 'block', marginBottom: '8px', fontSize: '13px', color: '#8b949e', fontWeight: '500' },
        metric: { fontSize: '11px', color: '#8b949e', textTransform: 'uppercase', letterSpacing: '0.5px', marginBottom: '4px' }
      };

      if (showSetup) {
        return e('div', { style: s.container },
          e('header', { style: s.header },
            e('div', { style: { display: 'flex', alignItems: 'center', gap: '12px' } },
              e('div', { style: { width: '36px', height: '36px', background: 'linear-gradient(135deg, #58a6ff 0%, #1f6feb 100%)', borderRadius: '10px', display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: '16px', fontWeight: 'bold', color: 'white' } }, 'CA'),
              e('h1', { style: { margin: 0, fontSize: '18px', fontWeight: '600' } }, 'Corp Actions')
            )
          ),
          e('main', { style: { padding: '16px' } },
            e('div', { style: s.card },
              e('h2', { style: { margin: '0 0 8px', fontSize: '18px', fontWeight: '600' } }, 'Get Started'),
              e('p', { style: { margin: '0 0 20px', color: '#8b949e', fontSize: '14px' } }, 'Enter your Polygon.io API key and a stock ticker.'),
              e('div', { style: { display: 'flex', flexDirection: 'column', gap: '16px' } },
                e('div', null,
                  e('label', { style: s.label }, 'API Key'),
                  e('input', { type: 'password', value: apiKey, onChange: function(ev) { setApiKey(ev.target.value); }, placeholder: 'Your Polygon.io API key', style: s.input }),
                  e('a', { href: 'https://polygon.io', target: '_blank', style: { fontSize: '12px', color: '#58a6ff', display: 'block', marginTop: '6px' } }, 'Get free API key ‚Üí')
                ),
                e('div', null,
                  e('label', { style: s.label }, 'Stock Ticker'),
                  e('input', { type: 'text', value: ticker, onChange: function(ev) { setTicker(ev.target.value.toUpperCase()); }, placeholder: 'e.g. AAPL, MSFT', style: s.input }),
                  recentSearches.length > 0 && e('div', { style: { display: 'flex', gap: '8px', marginTop: '8px', flexWrap: 'wrap' } },
                    recentSearches.map(function(t) { return e('button', { key: t, onClick: function() { setTicker(t); }, style: { padding: '6px 12px', background: 'rgba(88,166,255,0.1)', border: '1px solid rgba(88,166,255,0.3)', borderRadius: '6px', color: '#58a6ff', fontSize: '12px', cursor: 'pointer' } }, t); })
                  )
                ),
                e('div', { style: { display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '12px' } },
                  e('div', null, e('label', { style: s.label }, 'Start Date'), e('input', { type: 'date', value: investmentDate, onChange: function(ev) { setInvestmentDate(ev.target.value); }, style: s.input })),
                  e('div', null, e('label', { style: s.label }, 'End Date'), e('input', { type: 'date', value: endDate, onChange: function(ev) { setEndDate(ev.target.value); }, style: s.input }))
                ),
                e('div', null, e('label', { style: s.label }, 'Investment Amount ($)'), e('input', { type: 'number', value: investmentAmount, onChange: function(ev) { setInvestmentAmount(parseFloat(ev.target.value) || 0); }, style: s.input })),
                e('button', { onClick: fetchData, disabled: loading || !ticker || !apiKey, style: Object.assign({}, s.btn, { opacity: (loading || !ticker || !apiKey) ? 0.6 : 1 }) }, loading ? 'Loading...' : 'Analyse')
              )
            ),
            error && e('div', { style: { background: 'rgba(248,81,73,0.1)', border: '1px solid rgba(248,81,73,0.4)', borderRadius: '12px', padding: '14px', color: '#f85149', fontSize: '14px' } }, error)
          )
        );
      }

      return e('div', { style: s.container },
        e('header', { style: s.header },
          e('div', { style: { display: 'flex', alignItems: 'center', justifyContent: 'space-between' } },
            e('div', { style: { display: 'flex', alignItems: 'center', gap: '12px' } },
              e('div', { style: { width: '36px', height: '36px', background: 'linear-gradient(135deg, #58a6ff 0%, #1f6feb 100%)', borderRadius: '10px', display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: '16px', fontWeight: 'bold', color: 'white' } }, 'CA'),
              e('div', null, e('h1', { style: { margin: 0, fontSize: '18px', fontWeight: '600' } }, 'Corp Actions'), searchedTicker && e('p', { style: { margin: 0, fontSize: '12px', color: '#58a6ff' } }, searchedTicker))
            ),
            e('button', { onClick: function() { setShowSetup(true); }, style: { padding: '8px 12px', background: 'rgba(48,54,61,0.5)', border: '1px solid rgba(48,54,61,0.8)', borderRadius: '8px', color: '#8b949e', fontSize: '12px', cursor: 'pointer' } }, 'Settings')
          )
        ),
        e('main', { style: { padding: '16px' } },
          error && e('div', { style: { background: 'rgba(248,81,73,0.1)', border: '1px solid rgba(248,81,73,0.4)', borderRadius: '12px', padding: '14px', marginBottom: '12px', color: '#f85149', fontSize: '14px' } }, error),
          tickerDetails && e('div', { style: Object.assign({}, s.card, { display: 'flex', alignItems: 'center', gap: '12px' }) },
            e('div', { style: { flex: 1 } }, e('div', { style: { fontSize: '20px', fontWeight: '700' } }, searchedTicker), e('div', { style: { fontSize: '13px', color: '#8b949e' } }, tickerDetails.name)),
            currentPrice && e('div', { style: { textAlign: 'right' } }, e('div', { style: { fontSize: '24px', fontWeight: '700' } }, formatCurrency(currentPrice)), divAnalysis && e('div', { style: { fontSize: '12px', color: '#3fb950' } }, divAnalysis.currentYield.toFixed(2) + '% yield'))
          ),
          e('div', { style: { display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '12px', marginBottom: '12px' } },
            returnCalc && e('div', { style: Object.assign({}, s.card, { marginBottom: 0, background: 'linear-gradient(135deg, rgba(46,160,67,0.15) 0%, rgba(35,134,54,0.1) 100%)', border: '1px solid rgba(46,160,67,0.3)' }) },
              e('div', { style: s.metric }, 'Total Return'),
              e('div', { style: { fontSize: '24px', fontWeight: '700', color: returnCalc.percentReturn >= 0 ? '#3fb950' : '#f85149' } }, formatPercent(returnCalc.percentReturn)),
              e('div', { style: { fontSize: '11px', color: '#8b949e' } }, returnCalc.annualizedReturn.toFixed(1) + '% p.a.')
            ),
            divAnalysis && e('div', { style: Object.assign({}, s.card, { marginBottom: 0 }) },
              e('div', { style: s.metric }, '5Y Div Growth'),
              e('div', { style: { fontSize: '24px', fontWeight: '700', color: divAnalysis.cagr5Year !== null && divAnalysis.cagr5Year >= 0 ? '#3fb950' : '#f85149' } }, divAnalysis.cagr5Year !== null ? formatPercent(divAnalysis.cagr5Year) : 'N/A'),
              e('div', { style: { fontSize: '11px', color: '#8b949e' } }, divAnalysis.consecutiveYears + 'yr streak')
            )
          ),
          returnCalc && e('div', { style: s.card },
            e('div', { style: { fontSize: '14px', fontWeight: '600', marginBottom: '12px' } }, 'Investment Summary'),
            e('div', { style: { display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '12px', fontSize: '13px' } },
              e('div', null, e('span', { style: { color: '#8b949e' } }, 'Invested: '), e('strong', null, formatCurrency(investmentAmount))),
              e('div', null, e('span', { style: { color: '#8b949e' } }, 'Final: '), e('strong', { style: { color: '#58a6ff' } }, formatCurrency(returnCalc.totalReturn))),
              e('div', null, e('span', { style: { color: '#8b949e' } }, 'Dividends: '), e('strong', { style: { color: '#3fb950' } }, formatCurrency(returnCalc.totalDividendIncome))),
              e('div', null, e('span', { style: { color: '#8b949e' } }, 'Period: '), e('strong', null, returnCalc.years.toFixed(1) + ' yrs'))
            )
          ),
          divAnalysis && divAnalysis.yearlyData && divAnalysis.yearlyData.length > 0 && e('div', { style: s.card },
            e('div', { style: { fontSize: '14px', fontWeight: '600', marginBottom: '8px' } }, 'Dividend Analysis'),
            e('div', { style: { display: 'grid', gridTemplateColumns: '1fr 1fr 1fr', gap: '8px', fontSize: '12px' } },
              e('div', null, e('span', { style: { color: '#8b949e' } }, 'Frequency'), e('br'), e('strong', null, divAnalysis.frequency)),
              e('div', null, e('span', { style: { color: '#8b949e' } }, 'Latest'), e('br'), e('strong', { style: { color: '#3fb950' } }, formatCurrency(divAnalysis.latestDividend))),
              e('div', null, e('span', { style: { color: '#8b949e' } }, 'Annual'), e('br'), e('strong', null, formatCurrency(divAnalysis.ttmDividendTotal)))
            ),
            e(DividendChart, { data: divAnalysis.yearlyData })
          ),
          e('div', { style: { display: 'flex', gap: '8px', marginBottom: '12px', overflowX: 'auto' } },
            ['dividends', 'splits', 'upcoming'].map(function(tab) {
              var cnt = tab === 'dividends' ? dividends.length : tab === 'splits' ? splits.length : stats.upcomingDividends.length + stats.upcomingSplits.length;
              return e('button', { key: tab, onClick: function() { setActiveTab(tab); }, style: { padding: '10px 16px', background: activeTab === tab ? 'rgba(31,111,235,0.2)' : 'rgba(48,54,61,0.3)', border: activeTab === tab ? '1px solid rgba(31,111,235,0.5)' : '1px solid transparent', borderRadius: '8px', color: activeTab === tab ? '#58a6ff' : '#8b949e', fontSize: '13px', fontWeight: '500', whiteSpace: 'nowrap', cursor: 'pointer' } }, tab.charAt(0).toUpperCase() + tab.slice(1) + ' (' + cnt + ')');
            })
          ),
          activeTab === 'dividends' && e('div', { style: Object.assign({}, s.card, { padding: 0, overflow: 'hidden' }) },
            dividends.length === 0 ? e('div', { style: { padding: '32px', textAlign: 'center', color: '#8b949e' } }, 'No dividend history') :
            e('div', { style: { maxHeight: '400px', overflowY: 'auto' } },
              dividends.slice(0, 50).map(function(div, i) {
                return e('div', { key: div.id || i, style: { display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '12px 16px', borderTop: i > 0 ? '1px solid rgba(48,54,61,0.4)' : 'none' } },
                  e('div', null, e('div', { style: { fontSize: '14px', fontWeight: '500' } }, formatDate(div.ex_dividend_date)), e('div', { style: { fontSize: '11px', color: '#8b949e' } }, 'Pay: ' + (div.pay_date ? formatDate(div.pay_date) : 'TBD'))),
                  e('div', { style: { textAlign: 'right' } }, e('div', { style: { fontSize: '16px', fontWeight: '600', color: '#3fb950' } }, formatCurrency(div.cash_amount)), e('div', { style: { fontSize: '10px', padding: '2px 6px', background: div.dividend_type === 'CD' ? 'rgba(46,160,67,0.15)' : 'rgba(187,128,9,0.15)', color: div.dividend_type === 'CD' ? '#3fb950' : '#d29922', borderRadius: '4px', display: 'inline-block' } }, div.dividend_type === 'CD' ? 'Regular' : div.dividend_type === 'SC' ? 'Special' : 'Cash'))
                );
              })
            )
          ),
          activeTab === 'splits' && e('div', { style: Object.assign({}, s.card, { padding: 0, overflow: 'hidden' }) },
            splits.length === 0 ? e('div', { style: { padding: '32px', textAlign: 'center', color: '#8b949e' } }, 'No stock splits') :
            e('div', null, splits.map(function(sp, i) {
              var rev = sp.split_from > sp.split_to;
              return e('div', { key: sp.id || i, style: { display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '14px 16px', borderTop: i > 0 ? '1px solid rgba(48,54,61,0.4)' : 'none' } },
                e('div', null, e('div', { style: { fontSize: '14px', fontWeight: '500' } }, formatDate(sp.execution_date)), e('div', { style: { fontSize: '12px', color: rev ? '#f85149' : '#3fb950' } }, rev ? 'Reverse' : 'Forward')),
                e('div', { style: { fontSize: '20px', fontWeight: '700', color: '#58a6ff', fontFamily: 'monospace' } }, sp.split_to + ':' + sp.split_from)
              );
            }))
          ),
          activeTab === 'upcoming' && e('div', { style: Object.assign({}, s.card, { padding: 0, overflow: 'hidden' }) },
            (stats.upcomingDividends.length === 0 && stats.upcomingSplits.length === 0) ? e('div', { style: { padding: '32px', textAlign: 'center', color: '#8b949e' } }, 'No upcoming events') :
            e('div', null,
              stats.upcomingDividends.map(function(div, i) {
                return e('div', { key: 'div-' + i, style: { display: 'flex', alignItems: 'center', gap: '12px', padding: '14px 16px', borderTop: i > 0 ? '1px solid rgba(48,54,61,0.4)' : 'none' } },
                  e('div', { style: { width: '40px', height: '40px', background: 'rgba(46,160,67,0.15)', borderRadius: '10px', display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: '18px' } }, 'üí∞'),
                  e('div', { style: { flex: 1 } }, e('div', { style: { fontWeight: '600' } }, 'Dividend: ' + formatCurrency(div.cash_amount)), e('div', { style: { fontSize: '12px', color: '#8b949e' } }, 'Ex-div: ' + formatDate(div.ex_dividend_date)))
                );
              }),
              stats.upcomingSplits.map(function(sp, i) {
                return e('div', { key: 'sp-' + i, style: { display: 'flex', alignItems: 'center', gap: '12px', padding: '14px 16px', borderTop: '1px solid rgba(48,54,61,0.4)' } },
                  e('div', { style: { width: '40px', height: '40px', background: 'rgba(31,111,235,0.15)', borderRadius: '10px', display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: '18px' } }, '‚úÇÔ∏è'),
                  e('div', { style: { flex: 1 } }, e('div', { style: { fontWeight: '600' } }, 'Split: ' + sp.split_to + ':' + sp.split_from), e('div', { style: { fontSize: '12px', color: '#8b949e' } }, formatDate(sp.execution_date)))
                );
              })
            )
          )
        ),
        e('div', { style: { position: 'fixed', bottom: 0, left: 0, right: 0, background: 'rgba(13,17,23,0.95)', backdropFilter: 'blur(20px)', borderTop: '1px solid rgba(48,54,61,0.6)', padding: '12px 16px', display: 'flex', gap: '8px' } },
          e('input', { type: 'text', value: ticker, onChange: function(ev) { setTicker(ev.target.value.toUpperCase()); }, placeholder: 'Ticker', style: Object.assign({}, s.input, { flex: 1, padding: '12px' }) }),
          e('button', { onClick: fetchData, disabled: loading || !ticker, style: { padding: '12px 24px', background: 'linear-gradient(135deg, #1f6feb 0%, #58a6ff 100%)', border: 'none', borderRadius: '10px', color: '#fff', fontSize: '14px', fontWeight: '600', opacity: (loading || !ticker) ? 0.6 : 1, cursor: 'pointer' } }, loading ? '...' : 'Go')
        )
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(e(App));
  </script>
</body>
</html>
